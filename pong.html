<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<title>Canvas</title>
	
	<style type="text/css" media="screen">
	* { margin: 0; padding: 0; outline: 0; }
	html, body { text-align: center; color: #4da612; }
	h1 { height: 133px; font-size:0; line-height: 0; text-indent: -4000px; }
	a { color: white; text-decoration: none }
	canvas { border: 1px solid #eee; cursor: crosshair; margin-top: 30px; }
	p { height: 22px; margin-top: 30px; font-size:0; line-height: 0; text-indent: -4000px; }
	</style>
	
	<script src="ncanvas.js" type="text/javascript" language="javascript" charset="utf-8" ></script>
	<script src="ncanvas-text.js" type="text/javascript" language="javascript" charset="utf-8" ></script>
	<script type="text/javascript" language="javascript" charset="utf-8">
	
	function init() {
		var n = document.getElementById("area").getNCanvas();
		//n.autoClear = false;
		n.node.globalAlpha = 1
		n.node.fillColor = n.node.strokeColor = 'white';
		var score = 0;
		var hits = 0;
		
		var mainScene = new NScene({name: 'main', fps: 60});
		
		var keys = {up: false, down: false, left: false, right: false};
		window.onkeydown = function(e) {
			switch(e.keyCode){
				case 38: keys.up = true; break;
				case 40: keys.down = true; break;
				case 37: keys.left = true; break;
				case 39: keys.right = true; break;
			}
		}
		window.onkeyup = function(e) {
			switch(e.keyCode){
				case 38: keys.up = false; break;
				case 40: keys.down = false; break;
				case 37: keys.left = false; break;
				case 39: keys.right = false; break;
			}
		}
		
		var stroke = '#4da612';
		
		
		var color = 'black'
		var s = 30;
		var points = [
			// 2
			new NPoint({x: -3.5*s, y: -2.5*s, z: 0, color: color}),
			new NPoint({x: -1.5*s, y: -2.5*s, z: 0, color: color}),
			new NPoint({x: -1.5*s, y: -0.5*s, z: 0, color: color}),
			new NPoint({x: -3.5*s, y: -0.5*s, z: 0, color: color}),
			new NPoint({x: -3.5*s, y: 2.5*s, z: 0, color: color}),
			new NPoint({x: -0.5*s, y: 2.5*s, z: 0, color: color}),
			new NPoint({x: -0.5*s, y: 1.5*s, z: 0, color: color}),
			new NPoint({x: -2.5*s, y: 1.5*s, z: 0, color: color}),
			new NPoint({x: -2.5*s, y: 0.5*s, z: 0, color: color}),
			new NPoint({x: -0.5*s, y: 0.5*s, z: 0, color: color}),
			new NPoint({x: -0.5*s, y: -1.5*s, z: 0, color: color}),
			new NPoint({x: -3.5*s, y: -1.5*s, z: 0, color: color}),
			// c
			new NPoint({x: 0.5*s, y: -1.5*s, z: 0, color: color}),
			new NPoint({x: 3.5*s, y: -1.5*s, z: 0, color: color}),
			new NPoint({x: 3.5*s, y: -0.5*s, z: 0, color: color}),
			new NPoint({x: 1.5*s, y: -0.5*s, z: 0, color: color}),
			new NPoint({x: 1.5*s, y: 1.5*s, z: 0, color: color}),
			new NPoint({x: 3.5*s, y: 1.5*s, z: 0, color: color}),
			new NPoint({x: 3.5*s, y: 2.5*s, z: 0, color: color}),
			new NPoint({x: 0.5*s, y: 2.5*s, z: 0, color: color}),
		];
		
		for	(index in points) {
			points.push(new NPoint({x: points[index].x, y: points[index].y, z: points[index].z - s*0.5, color: color}));
			points[index].z += s*0.5;
		}
		
		var poly = new NPolygon({x: n.width/2, y: n.height/2, z: 0});
		poly.setPoints(points);
		// front
		poly.connectRange(0, 11);
		poly.connectRange(20, 31);
		
		poly.connectRange(12, 19);
		poly.connectRange(32, 39);
		
		// side
		poly.connect(0, 20, 31, 11);
		poly.connect(1, 21, 22, 2);
		poly.connect(10, 30, 29, 9);
		poly.connect(3, 23, 24, 4);
		poly.connect(8, 28, 27, 7);
		poly.connect(6, 26, 25, 5);
		
		poly.connect(12, 32, 39, 19);
		poly.connect(13, 33, 34, 14);
		poly.connect(17, 37, 38, 18);
		poly.connect(15, 35, 36, 16);
		// top
		poly.connect(0, 20, 21, 1);
		poly.connect(11, 31, 30, 10);
		poly.connect(3, 23, 22, 2);
		poly.connect(8, 28, 29, 9);
		poly.connect(7, 27, 26, 6);
		poly.connect(4, 24, 25, 5);
		
		poly.connect(12, 32, 33, 13);
		poly.connect(15, 35, 34, 14);
		poly.connect(16, 36, 37, 17);
		poly.connect(19, 39, 38, 18);
		
		
		var camera = new NPoint({x: n.width/2, y: n.height/2, z: 300});
		
		var theta = Math.PI/180;
		var thetaX = 0*theta, thetaY = 1*theta, thetaZ = 0*theta;
		var i = 0;
		
		mainScene.addListener('onEnterFrame', function(e) {
			i++;
				
			poly.rotationX += thetaX
			poly.rotationY += thetaY
			poly.rotationZ += thetaZ
			poly.draw(n.node, camera);
			
			if( i >= 80) {
				//n.stop();
			}
		});
		
		n.node.canvas.onmousemove = function(e) {
		return;
			//n.clear();
			poly.y = poly2.y = poly3.y = e.clientY - e.target.offsetTop
			poly.x = poly2.x = poly3.x = e.clientX - e.target.offsetLeft
		return
			poly.y = e.clientY - e.target.offsetTop
			poly.x = e.clientX - e.target.offsetLeft
		return;
			poly.rotationX = ((n.width/2 - (e.clientY - e.target.offsetTop) - 50)/(n.width/2)) * Math.PI/4
			poly.rotationY = (((e.clientX - e.target.offsetLeft) - n.height/2 - 50)/(n.height/2)) * Math.PI/4
		}
		
		n.node.canvas.onmousedown = function(e) {
			poly.y = e.clientY - e.target.offsetTop
			poly.x = e.clientX - e.target.offsetLeft
		}
		
		n.node.canvas.onmousewheel = function(e) {
			var step = 8 - 16*(e.wheelDelta < 0);
			poly.z += step
		}
		
		n.play(mainScene, mainScene.fps);
	}
	</script>
</head>
<body onload="init();"><h1>PONG</h1><canvas id="area" width="400" height="300">You are so not 2010!</canvas><p>By Siyan Panayotov</p></body>
</html>
