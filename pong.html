<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<title>Canvas</title>
	
	<style type="text/css" media="screen">
	* { margin: 0; padding: 0; outline: 0; }
	html, body { text-align: center; color: #4da612; }
	h1 { display: none }
	a { color: white; text-decoration: none }
	canvas { border: 1px solid #eee; cursor: crosshair; margin-top: 30px; }
	p { height: 22px; margin-top: 30px; font-size:0; line-height: 0; text-indent: -4000px; }
	</style>
	
	<script src="ncanvas.js" type="text/javascript" language="javascript" charset="utf-8" ></script>
	<script src="ncanvas-text.js" type="text/javascript" language="javascript" charset="utf-8" ></script>
	<script type="text/javascript" language="javascript" charset="utf-8">
	
	function init() {
		var n = document.getElementById("area").getNCanvas();
		//n.autoClear = false;
		n.node.globalAlpha = 1
		
		var mainScene = new NScene({name: 'main', fps: 30});
		var stroke = '#4da612';
		
		var type = 'stroke';
		var type2 = 'fill';
		var color1 = 'black';
		var color2 = '#c92424';
		var color3 = '#666666';	
		var s = 200;
		var points = [
			// 2
			new NPoint({x: -3.5*s, y: -2.5*s, z: 0, color: color1}),
			new NPoint({x: -1.5*s, y: -2.5*s, z: 0, color: color1}),
			new NPoint({x: -1.5*s, y: -0.5*s, z: 0, color: color1}),
			new NPoint({x: -3.5*s, y: -0.5*s, z: 0, color: color1}),
			new NPoint({x: -3.5*s, y: 2.5*s, z: 0, color: color1}),
			new NPoint({x: -0.5*s, y: 2.5*s, z: 0, color: color1}),
			new NPoint({x: -0.5*s, y: 1.5*s, z: 0, color: color1}),
			new NPoint({x: -2.5*s, y: 1.5*s, z: 0, color: color1}),
			new NPoint({x: -2.5*s, y: 0.5*s, z: 0, color: color1}),
			new NPoint({x: -0.5*s, y: 0.5*s, z: 0, color: color1}),
			new NPoint({x: -0.5*s, y: -1.5*s, z: 0, color: color1}),
			new NPoint({x: -3.5*s, y: -1.5*s, z: 0, color: color1}),
			// c
			new NPoint({x: 0.5*s, y: -1.5*s, z: 0, color: color2}),
			new NPoint({x: 3.5*s, y: -1.5*s, z: 0, color: color2}),
			new NPoint({x: 3.5*s, y: -0.5*s, z: 0, color: color2}),
			new NPoint({x: 1.5*s, y: -0.5*s, z: 0, color: color2}),
			new NPoint({x: 1.5*s, y: 1.5*s, z: 0, color: color2}),
			new NPoint({x: 3.5*s, y: 1.5*s, z: 0, color: color2}),
			new NPoint({x: 3.5*s, y: 2.5*s, z: 0, color: color2}),
			new NPoint({x: 0.5*s, y: 2.5*s, z: 0, color: color2}),
		];
		
		for	(index in points) {
			points[index].z += s*0.5;
			points[index].lineColor = points[index].color;
			points.push(new NPoint({x: points[index].x, y: points[index].y, z: points[index].z - s*1, color: points[index].color, lineColor: points[index].lineColor}));
		}
		
		var poly = new NPolygon({x: n.width/2, y: n.height/2, z: -2500});
		poly.setPoints(points);
		// front
		poly.connectRange(type2, 0, 11);
		poly.connectRange(type, 20, 31);
		
		poly.connectRange(type2, 12, 19);
		poly.connectRange(type, 32, 39);
		
		// side
		poly.connect(type, 0, 20, 31, 11);
		poly.connect(type, 1, 21, 22, 2);
		poly.connect(type, 10, 30, 29, 9);
		poly.connect(type, 3, 23, 24, 4);
		poly.connect(type, 8, 28, 27, 7);
		poly.connect(type, 6, 26, 25, 5);
		
		poly.connect(type, 12, 32, 39, 19);
		poly.connect(type, 13, 33, 34, 14);
		poly.connect(type, 17, 37, 38, 18);
		poly.connect(type, 15, 35, 36, 16);
		// top
		poly.connect(type, 0, 20, 21, 1);
		poly.connect(type, 11, 31, 30, 10);
		poly.connect(type, 3, 23, 22, 2);
		poly.connect(type, 8, 28, 29, 9);
		poly.connect(type, 7, 27, 26, 6);
		poly.connect(type, 4, 24, 25, 5);
		
		poly.connect(type, 12, 32, 33, 13);
		poly.connect(type, 15, 35, 34, 14);
		poly.connect(type, 16, 36, 37, 17);
		poly.connect(type, 19, 39, 38, 18);
		
		
		var camera = new NPoint({x: n.width/2, y: n.height/2, z: 800, color: '#00ff00'});
		
		var theta = Math.PI/180;
		var thetaX = 0*theta, thetaY = 0*theta, thetaZ = 0*theta;
		var i = 0;
		var k = 0.1;
		var anim = {x: poly.x, y: poly.y, z: poly.z, rx: 0, ry: 0, rz: poly.rotationZ};
		var wobble = -1;
		
		mainScene.addListener('onEnterFrame', function(e) {
			i++;
			
			poly.rotationX += (anim.rx - poly.rotationX)*k
			poly.rotationY += (anim.ry - poly.rotationY)*k
			poly.rotationZ += (anim.rz - poly.rotationZ)*k
			poly.x += (anim.x - poly.x)*k
			poly.y += (anim.y - poly.y)*k
			poly.z += (anim.z - poly.z)*k
			
			poly.draw(n.node, camera);
			
			if( 0 && i >= 1) {
				n.stop();
			}
		});
		
		n.node.canvas.onmousemove = function(e) {
			anim.rx = ((n.height/2 - (e.clientY - e.target.offsetTop))/(n.height/2)) * Math.PI/2
			anim.ry = (((e.clientX - e.target.offsetLeft) - n.width/2)/(n.width/2)) * Math.PI/2
			
			//anim.y = e.clientY - e.target.offsetTop
			//anim.x = e.clientX - e.target.offsetLeft
		}
		
		n.node.canvas.onmousedown = function(e) {
			wobble *= -1;
			poly.x = anim.x =  n.width/2 + wobble*700
			return;
			n.node.canvas.onmousemove(e);
		}
		
		n.node.canvas.onmousewheel = function(e) {
			var step = 1 - 2*(e.wheelDelta < 0);
			anim.z += step*150
		}
		
		n.play(mainScene, mainScene.fps);
	}
	</script>
</head>
<body onload="init();"><h1></h1><canvas id="area" width="800" height="600">You are so not 2010!</canvas><p>By Siyan Panayotov</p></body>
</html>
