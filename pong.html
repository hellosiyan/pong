<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<title>Canvas</title>
	
	<style type="text/css" media="screen">
	* { margin: 0; padding: 0; outline: 0; }
	html, body { text-align: center; color: #4da612; }
	h1 { display: none }
	a { color: white; text-decoration: none }
	canvas { border: 1px solid #eee; cursor: crosshair; margin-top: 30px; }
	p { height: 22px; margin-top: 30px; font-size:0; line-height: 0; text-indent: -4000px; }
	</style>
	
	<script src="ncanvas.js" type="text/javascript" language="javascript" charset="utf-8" ></script>
	<script src="ncanvas-text.js" type="text/javascript" language="javascript" charset="utf-8" ></script>
	<script type="text/javascript" language="javascript" charset="utf-8">
	
	function init() {
		var n = document.getElementById("area").getNCanvas();
		//n.autoClear = false;
		n.node.globalAlpha = 1
		n.node.fillColor = n.node.strokeColor = 'white';
		var score = 0;
		var hits = 0;
		
		var mainScene = new NScene({name: 'main', fps: 30});
		
		var keys = {up: false, down: false, left: false, right: false};
		window.onkeydown = function(e) {
			switch(e.keyCode){
				case 38: keys.up = true; break;
				case 40: keys.down = true; break;
				case 37: keys.left = true; break;
				case 39: keys.right = true; break;
			}
		}
		window.onkeyup = function(e) {
			switch(e.keyCode){
				case 38: keys.up = false; break;
				case 40: keys.down = false; break;
				case 37: keys.left = false; break;
				case 39: keys.right = false; break;
			}
		}
		
		var stroke = '#4da612';
		
		var type = 'fill';
		var color1 = 'black';
		var color2 = '#c92424';
		var color3 = '#666666';
		var s = 200;
		var points = [
			// 2
			new NPoint({x: -3.5*s, y: -2.5*s, z: 0, color: color1}),
			new NPoint({x: -1.5*s, y: -2.5*s, z: 0, color: color1}),
			new NPoint({x: -1.5*s, y: -0.5*s, z: 0, color: color1}),
			new NPoint({x: -3.5*s, y: -0.5*s, z: 0, color: color1}),
			new NPoint({x: -3.5*s, y: 2.5*s, z: 0, color: color1}),
			new NPoint({x: -0.5*s, y: 2.5*s, z: 0, color: color1}),
			new NPoint({x: -0.5*s, y: 1.5*s, z: 0, color: color1}),
			new NPoint({x: -2.5*s, y: 1.5*s, z: 0, color: color1}),
			new NPoint({x: -2.5*s, y: 0.5*s, z: 0, color: color1}),
			new NPoint({x: -0.5*s, y: 0.5*s, z: 0, color: color1}),
			new NPoint({x: -0.5*s, y: -1.5*s, z: 0, color: color1}),
			new NPoint({x: -3.5*s, y: -1.5*s, z: 0, color: color1}),
			// c
			new NPoint({x: 0.5*s, y: -1.5*s, z: 0, color: color2}),
			new NPoint({x: 3.5*s, y: -1.5*s, z: 0, color: color2}),
			new NPoint({x: 3.5*s, y: -0.5*s, z: 0, color: color2}),
			new NPoint({x: 1.5*s, y: -0.5*s, z: 0, color: color2}),
			new NPoint({x: 1.5*s, y: 1.5*s, z: 0, color: color2}),
			new NPoint({x: 3.5*s, y: 1.5*s, z: 0, color: color2}),
			new NPoint({x: 3.5*s, y: 2.5*s, z: 0, color: color2}),
			new NPoint({x: 0.5*s, y: 2.5*s, z: 0, color: color2}),
		];
		
		for	(index in points) {
			points[index].z += s*0.5;
			points[index].lineColor = points[index].color;
			points.push(new NPoint({x: points[index].x, y: points[index].y, z: points[index].z - s*1, color: points[index].color, lineColor: points[index].lineColor}));
		}
		
		// floor
		/*
		points.push(new NPoint({x: 4.5*s, y: 3*s, z: 2*s, color: color3, lineColor: color3}));
		points.push(new NPoint({x: 4.5*s, y: 3*s, z: -2*s, color: color3, lineColor: color3}));
		points.push(new NPoint({x: -4.5*s, y: 3*s, z: -2*s, color: color3, lineColor: color3}));
		points.push(new NPoint({x: -4.5*s, y: 3*s, z: 2*s, color: color3, lineColor: color3}));
		*/
		var poly = new NPolygon({x: n.width/2, y: n.height/2, z: -1000});
		poly.setPoints(points);
		// front
		poly.connectRange(type, 0, 11);
		poly.connectRange(type, 20, 31);
		
		poly.connectRange(type, 12, 19);
		poly.connectRange(type, 32, 39);
		/*
		poly.connectRange(type, 40, 43);
		*/
		// side
		poly.connect(type, 0, 20, 31, 11);
		poly.connect(type, 1, 21, 22, 2);
		poly.connect(type, 10, 30, 29, 9);
		poly.connect(type, 3, 23, 24, 4);
		poly.connect(type, 8, 28, 27, 7);
		poly.connect(type, 6, 26, 25, 5);
		
		poly.connect(type, 12, 32, 39, 19);
		poly.connect(type, 13, 33, 34, 14);
		poly.connect(type, 17, 37, 38, 18);
		poly.connect(type, 15, 35, 36, 16);
		// top
		poly.connect(type, 0, 20, 21, 1);
		poly.connect(type, 11, 31, 30, 10);
		poly.connect(type, 3, 23, 22, 2);
		poly.connect(type, 8, 28, 29, 9);
		poly.connect(type, 7, 27, 26, 6);
		poly.connect(type, 4, 24, 25, 5);
		
		poly.connect(type, 12, 32, 33, 13);
		poly.connect(type, 15, 35, 34, 14);
		poly.connect(type, 16, 36, 37, 17);
		poly.connect(type, 19, 39, 38, 18);
		
		
		var camera = new NPoint({x: n.width/2, y: n.height/2, z: 800, color: '#00ff00'});
		
		var theta = Math.PI/180;
		var thetaX = 0*theta, thetaY = 0*theta, thetaZ = 0*theta;
		var i = 0;
		
		mainScene.addListener('onEnterFrame', function(e) {
			i++;
			
			poly.rotationX += thetaX
			poly.rotationY += thetaY
			poly.rotationZ += thetaZ
			poly.draw(n.node, camera);
			
			n.node.beginPath();
			n.node.fillStyle = '#00ff00';
			n.node.arc(camera.x, camera.y, 3, 0, Math.PI*2, true);
			n.node.closePath();
			n.node.fill();
			
			if( i >= 1) {
				//n.stop();
			}
		});
		
		n.node.canvas.onmousemove = function(e) {
			poly.rotationX = ((n.height/2 - (e.clientY - e.target.offsetTop))/(n.height/2)) * Math.PI/2
			poly.rotationY = (((e.clientX - e.target.offsetLeft) - n.width/2)/(n.width/2)) * Math.PI/2
		}
		
		n.node.canvas.onmousedown = function(e) {
			poly.y = e.clientY - e.target.offsetTop
			poly.x = e.clientX - e.target.offsetLeft
		}
		
		n.node.canvas.onmousewheel = function(e) {
			var step = 8 - 16*(e.wheelDelta < 0);
			poly.z += step
		}
		
		n.play(mainScene, mainScene.fps);
	}
	</script>
</head>
<body onload="init();"><h1></h1><canvas id="area" width="800" height="600">You are so not 2010!</canvas><p>By Siyan Panayotov</p></body>
</html>
