<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<title>Canvas</title>
	
	<style type="text/css" media="screen">
	* { margin: 0; padding: 0; outline: 0; }
	html, body { background: black; text-align: center; color: #4da612; }
	h1 { height: 133px; font-size:0; line-height: 0; text-indent: -4000px; }
	a { color: white; text-decoration: none }
	canvas { border: 1px solid white; cursor: crosshair; margin-top: 30px; }
	p { height: 22px; margin-top: 30px; font-size:0; line-height: 0; text-indent: -4000px; }
	</style>
	
	<script src="ncanvas.js" type="text/javascript" language="javascript" charset="utf-8" ></script>
	<script src="ncanvas-text.js" type="text/javascript" language="javascript" charset="utf-8" ></script>
	<script type="text/javascript" language="javascript" charset="utf-8">
	
	function init() {
		var n = document.getElementById("area").getNCanvas();
		//n.autoClear = false;
		var score = 0;
		var hits = 0;
		
		var mainScene = new NScene({name: 'main', fps: 40});
		
		var r = new NRect({x: n.width/2 - 50, y: n.height/2 - 50, width: 100, height: 100, fillColor: '#4da612'});
		r.x = 200
		r.center.x = n.width/2;
		r.center.y = n.height/2;
		//r.addTo(mainScene);
		
		var keys = {up: false, down: false, left: false, right: false};
		window.onkeydown = function(e) {
			switch(e.keyCode){
				case 38: keys.up = true; break;
				case 40: keys.down = true; break;
				case 37: keys.left = true; break;
				case 39: keys.right = true; break;
			}
		}
		window.onkeyup = function(e) {
			switch(e.keyCode){
				case 38: keys.up = false; break;
				case 40: keys.down = false; break;
				case 37: keys.left = false; break;
				case 39: keys.right = false; break;
			}
		}
		
		var stroke = '#4da612';
		
		var camera = new NPoint({x: n.width/2, y: n.height/2, z: 300});
		
//		stroke = '#ffffff';
		var points = [
			new NPoint({x: - 50, y: - 50, z: -25, color: '#D4A5A6'}),
			new NPoint({x: + 50, y: - 50, z: -25, color: '#D4A5A6'}),
			new NPoint({x: + 0, y: - 0, z: -25, color: '#901E1F'}),
			new NPoint({x: - 50, y: + 50, z: -25, color: '#D4A5A6'}),
			new NPoint({x: + 50, y: + 50, z: -25, color: '#D4A5A6'}),
			/*new NPoint({x: - 10, y: - 30, z: 0}),
			new NPoint({x: + 30, y: - 30, z: 0}),
			new NPoint({x: - 10, y: - 10, z: 0}),
			new NPoint({x: + 30, y: - 10, z: 0}),
			new NPoint({x: - 30, y: + 10, z: 0}),
			new NPoint({x: + 10, y: + 10, z: 0}),
			new NPoint({x: - 30, y: + 30, z: 0}),
			new NPoint({x: + 10, y: + 30, z: 0}),*/
			
			new NPoint({x: + 0, y: - 0, z: 25, color: '#4D901E'}),
			new NPoint({x: - 50, y: - 50, z: 25, color: '#C4D4A5'}),
			new NPoint({x: + 50, y: - 50, z: 25, color: '#C4D4A5'}),
			new NPoint({x: - 50, y: + 50, z: 25, color: '#C4D4A5'}),
			new NPoint({x: + 50, y: + 50, z: 25, color: '#C4D4A5'}),
		];
		
		var poly = new NPolygon({x: camera.x, y: camera.y, z: -100});
		poly.setPoints(points);
		
		var theta = Math.PI/60;
		var thetaX = 1*theta, thetaY = 1*theta, thetaZ = 1*theta;
		var i = 0;
		
		mainScene.addListener('onEnterFrame', function(e) {
			i++;
				
			//poly.x += 1.2;
			poly.rotationX += thetaX
			poly.rotationY += thetaY
			poly.rotationZ += thetaZ
			poly.draw(n.node, camera);
			//poly.z += 2;
			/*
			points[0].lineTo(n.node, points[1])
			points[0].lineTo(n.node, points[6])
			
			points[3].lineTo(n.node, points[1])
			points[3].lineTo(n.node, points[2])
			
			points[4].lineTo(n.node, points[5])
			points[4].lineTo(n.node, points[2])
			
			points[7].lineTo(n.node, points[6])
			points[7].lineTo(n.node, points[9])
			
			points[8].lineTo(n.node, points[9])
			points[8].lineTo(n.node, points[10])
			
			points[11].lineTo(n.node, points[5])
			points[11].lineTo(n.node, points[10])
			*/
			/*
			n.node.beginPath();
			n.node.fillStyle = '#4da612';
			n.node.arc(rc.x, rc.y, 2, 0, Math.PI*2, true);
			n.node.closePath();
			n.node.fill();
			*/
			// r.z -= 1 - 3*keys.up;
			if( i >= 320) {
				//n.stop();
			}
		});
		
		n.node.canvas.onmousemove = function(e) {
			poly.y = e.clientY - e.target.offsetTop
			poly.x = e.clientX - e.target.offsetLeft
		return;
			poly.rotationX = ((n.width/2 - (e.clientY - e.target.offsetTop) - 50)/(n.width/2)) * Math.PI/4
			poly.rotationY = (((e.clientX - e.target.offsetLeft) - n.height/2 - 50)/(n.height/2)) * Math.PI/4
		}
		
		n.node.canvas.onmousedown = function(e) {
			poly.y = e.clientY - e.target.offsetTop
			poly.x = e.clientX - e.target.offsetLeft
		}
		
		n.node.canvas.onmousewheel = function(e) {
			poly.z += 8 - 16*(e.wheelDelta < 0)
			console.log(poly.z )
		}
		
		n.play(mainScene, mainScene.fps);
	}
	</script>
</head>
<body onload="init();"><h1>PONG</h1><canvas id="area" width="400" height="300">You are so not 2010!</canvas><p>By Siyan Panayotov</p></body>
</html>
